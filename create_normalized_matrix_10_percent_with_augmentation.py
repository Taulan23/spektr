#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–°–û–ó–î–ê–ù–ò–ï –ù–û–†–ú–ê–õ–ò–ó–û–í–ê–ù–ù–û–ô –ú–ê–¢–†–ò–¶–´ –û–®–ò–ë–û–ö –î–õ–Ø 10% –®–£–ú–ê –° –ê–£–ì–ú–ï–ù–¢–ê–¶–ò–ï–ô –®–£–ú–ê
"""

import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd

def create_normalized_matrix_10_percent_with_augmentation():
    """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫ –¥–ª—è 10% —à—É–º–∞ —Å –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π"""
    
    # –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ –¥–ª—è 10% —à—É–º–∞ –° –ê–£–ì–ú–ï–ù–¢–ê–¶–ò–ï–ô
    # –ò–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ extra_trees_1712_with_noise_training.py
    confusion_matrix_10_percent_augmented = np.array([
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –±–µ—Ä–µ–∑–∞
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –¥—É–±
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –µ–ª—å
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –µ–ª—å_–≥–æ–ª—É–±–∞—è
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –∏–≤–∞
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –∫–∞—à—Ç–∞–Ω
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –∫–ª–µ–Ω
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –∫–ª–µ–Ω_–∞–º
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –ª–∏–ø–∞
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –ª–∏—Å—Ç–≤–µ–Ω–Ω–∏—Ü–∞
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –æ—Ä–µ—Ö
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # –æ—Å–∏–Ω–∞
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # —Ä—è–±–∏–Ω–∞
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # —Å–∏—Ä–µ–Ω—å
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # —Å–æ—Å–Ω–∞
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # —Ç–æ–ø–æ–ª—å_–±–∞–ª—å–∑–∞–º–∏—á–µ—Å–∫–∏–π
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # —Ç–æ–ø–æ–ª—å_—á–µ—Ä–Ω—ã–π
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # —Ç—É—è
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033],  # —á–µ—Ä–µ–º—É—Ö–∞
        [0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033]   # —è—Å–µ–Ω—å
    ])
    
    # –ù–∞–∑–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤
    class_names = [
        '–±–µ—Ä–µ–∑–∞', '–¥—É–±', '–µ–ª—å', '–µ–ª—å_–≥–æ–ª—É–±–∞—è', '–∏–≤–∞', '–∫–∞—à—Ç–∞–Ω', '–∫–ª–µ–Ω', '–∫–ª–µ–Ω_–∞–º',
        '–ª–∏–ø–∞', '–ª–∏—Å—Ç–≤–µ–Ω–Ω–∏—Ü–∞', '–æ—Ä–µ—Ö', '–æ—Å–∏–Ω–∞', '—Ä—è–±–∏–Ω–∞', '—Å–∏—Ä–µ–Ω—å', '—Å–æ—Å–Ω–∞',
        '—Ç–æ–ø–æ–ª—å_–±–∞–ª—å–∑–∞–º–∏—á–µ—Å–∫–∏–π', '—Ç–æ–ø–æ–ª—å_—á–µ—Ä–Ω—ã–π', '—Ç—É—è', '—á–µ—Ä–µ–º—É—Ö–∞', '—è—Å–µ–Ω—å'
    ]
    
    # –°–æ–∑–¥–∞–µ–º DataFrame –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    df_cm = pd.DataFrame(confusion_matrix_10_percent_augmented, 
                        index=class_names, 
                        columns=class_names)
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    plt.figure(figsize=(16, 14))
    plt.rcParams['font.size'] = 10
    
    # –°–æ–∑–¥–∞–µ–º —Ç–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É
    sns.heatmap(df_cm, 
                annot=True, 
                fmt='.3f', 
                cmap='RdYlBu_r', 
                cbar_kws={'label': '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å'},
                square=True,
                linewidths=0.5,
                linecolor='white',
                annot_kws={'size': 8})
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –º–µ—Ç–æ–∫
    plt.title('–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ Extra Trees (1712 –¥–µ—Ä–µ–≤—å–µ–≤)\n10% —à—É–º–∞ –° –ê–£–ì–ú–ï–ù–¢–ê–¶–ò–ï–ô –®–£–ú–ê', 
              fontsize=16, fontweight='bold', pad=20)
    plt.xlabel('–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å', fontsize=12, fontweight='bold')
    plt.ylabel('–ò—Å—Ç–∏–Ω–Ω—ã–π –∫–ª–∞—Å—Å', fontsize=12, fontweight='bold')
    
    # –ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –º–µ—Ç–∫–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
    plt.xticks(rotation=45, ha='right')
    plt.yticks(rotation=0)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ—á–Ω–æ—Å—Ç–∏
    accuracy = np.trace(confusion_matrix_10_percent_augmented) / len(confusion_matrix_10_percent_augmented) * 100
    plt.figtext(0.5, 0.02, 
                f'–û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å: {accuracy:.1f}% | Extra Trees (n_estimators=1712) | 10% —à—É–º–∞ –° –ê–£–ì–ú–ï–ù–¢–ê–¶–ò–ï–ô',
                ha='center', fontsize=12, fontweight='bold',
                bbox=dict(boxstyle="round,pad=0.3", facecolor="lightcoral", alpha=0.7))
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–∫–µ—Ç–∞
    plt.tight_layout()
    plt.subplots_adjust(bottom=0.1)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    filename = 'normalized_confusion_matrix_10_percent_noise_WITH_AUGMENTATION.png'
    plt.savefig(filename, dpi=300, bbox_inches='tight', facecolor='white')
    print(f"‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –° –ê–£–ì–ú–ï–ù–¢–ê–¶–ò–ï–ô —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: {filename}")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    plt.show()
    
    # –í—ã–≤–æ–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    print(f"\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ú–ê–¢–†–ò–¶–´ –° –ê–£–ì–ú–ï–ù–¢–ê–¶–ò–ï–ô:")
    print(f"   ‚Ä¢ –û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å: {accuracy:.1f}%")
    print(f"   ‚Ä¢ –†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã: {confusion_matrix_10_percent_augmented.shape}")
    print(f"   ‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤: {len(class_names)}")
    
    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –±–µ–∑ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
    print(f"\nüìä –°–†–ê–í–ù–ï–ù–ò–ï –° –†–ï–ó–£–õ–¨–¢–ê–¢–ê–ú–ò –ë–ï–ó –ê–£–ì–ú–ï–ù–¢–ê–¶–ò–ò:")
    print(f"   ‚Ä¢ –° –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π: {accuracy:.1f}%")
    print(f"   ‚Ä¢ –ë–µ–∑ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏: 90.4%")
    print(f"   ‚Ä¢ –†–∞–∑–Ω–∏—Ü–∞: {accuracy - 90.4:.1f}%")
    
    if accuracy < 90.4:
        print(f"   ‚Ä¢ –í—ã–≤–æ–¥: –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è —à—É–º–∞ –°–ù–ò–ñ–ê–ï–¢ —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ {90.4 - accuracy:.1f}%")
        print(f"   ‚Ä¢ –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –¥–ª—è –¥–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ —á–∏—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö!")
    else:
        print(f"   ‚Ä¢ –í—ã–≤–æ–¥: –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è —à—É–º–∞ –ø–æ–≤—ã—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ {accuracy - 90.4:.1f}%")
    
    print(f"\nüîç –û–°–û–ë–ï–ù–ù–û–°–¢–ò –ú–ê–¢–†–ò–¶–´ –° –ê–£–ì–ú–ï–ù–¢–ê–¶–ò–ï–ô:")
    print(f"   ‚Ä¢ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–≤–Ω—ã 0.033 (1/30)")
    print(f"   ‚Ä¢ –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —É–≥–∞–¥—ã–≤–∞–Ω–∏–µ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –∫–ª–∞—Å—Å–∞–º–∏")
    print(f"   ‚Ä¢ –ú–æ–¥–µ–ª—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ—Ç–µ—Ä—è–ª–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏")

if __name__ == "__main__":
    create_normalized_matrix_10_percent_with_augmentation() 