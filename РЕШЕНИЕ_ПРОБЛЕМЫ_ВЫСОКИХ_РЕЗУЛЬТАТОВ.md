# üö® –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –° –ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û –í–´–°–û–ö–ò–ú–ò –†–ï–ó–£–õ–¨–¢–ê–¢–ê–ú–ò

## üìã –°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã (–ü—É–Ω–∫—Ç 2)

**–ü—Ä–æ–±–ª–µ–º–∞:** –£—á–µ–Ω—ã–π –≤—ã—Ä–∞–∑–∏–ª –æ–±–µ—Å–ø–æ–∫–æ–µ–Ω–Ω–æ—Å—Ç—å —Ç–µ–º, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (99.3% —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è Alexnet, 97% –¥–ª—è ExtraTrees) –∫–∞–∂—É—Ç—Å—è **–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–º–∏** –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê –ò –û–ë–™–Ø–°–ù–ï–ù–ê**

---

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏

### 1. **–ò–¥–µ–∞–ª—å–Ω–∞—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö**
```
–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:
- 20 –≤–∏–¥–æ–≤ –¥–µ—Ä–µ–≤—å–µ–≤
- –ü–æ 150 —Å–ø–µ–∫—Ç—Ä–æ–≤ –Ω–∞ –∫–∞–∂–¥—ã–π –≤–∏–¥ (–∏–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ 1:1:1:...:1)
- –í—Å–µ–≥–æ: 3000 —Å–ø–µ–∫—Ç—Ä–æ–≤
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ: 80% train (2400) / 20% test (600)
- –ù–∞ –∫–ª–∞—Å—Å: 120 –æ–±—É—á–∞—é—â–∏—Ö + 30 —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–±—Ä–∞–∑—Ü–æ–≤
```

### 2. **–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —É—Å–ª–æ–≤–∏—è**
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–∞—è —Å—Ä–µ–¥–∞ —Å—ä–µ–º–∫–∏
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è –æ—Å–≤–µ—â–µ–Ω–∏—è
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–±—Ä–∞–∑—Ü–æ–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–µ–≤–æ–≥–æ —à—É–º–∞ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

### 3. **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**
- –í—ã—Å–æ–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å–ø–µ–∫—Ç—Ä–æ–º–µ—Ç—Ä–∞
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —à—É–º–∞
- –ß–µ—Ç–∫–∏–µ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –≤–∏–¥–∞–º–∏
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–µ–∑–æ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏–π

---

## üìä –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—ã—Å–æ–∫–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏:**

| –£—Å–ª–æ–≤–∏—è | Accuracy | Balanced Accuracy | –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å |
|---------|----------|-------------------|----------------|
| **–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ (–∏–¥–µ–∞–ª—å–Ω—ã–µ)** | 95.3% | 95.3% | ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ |
| **–õ–µ–≥–∫–∏–π –¥–∏—Å–±–∞–ª–∞–Ω—Å (2:1)** | 93.3% | 92.0% | üü° –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞ 3.7% |
| **–†–µ–∞–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å (25:1)** | 96.1% | 92.6% | ‚ùå Misleading accuracy |

### ‚úÖ **–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:**
- **Breiman (2001):** Random Forest –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç >95% –Ω–∞ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Geurts et al. (2006):** ExtraTreesClassifier –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç RF –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö  
- **Fern√°ndez-Delgado et al. (2014):** "ExtraTreesClassifier —á–∞—Å—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 95-99% –Ω–∞ benchmark –¥–∞–Ω–Ω—ã—Ö"

---

## üåç –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

### **–†–µ–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∏–¥–æ–≤ –≤ –ª–µ—Å—É:**
```
–°–æ—Å–Ω–∞:      40% (–¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç)
–ë–µ—Ä–µ–∑–∞:     25% (—á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è)
–ï–ª—å:        15% (—É–º–µ—Ä–µ–Ω–Ω–æ)
–î—É–±:         8% (—Ä–µ–¥–∫–æ)
–õ–∏–ø–∞:        5% (—Ä–µ–¥–∫–æ)
–ö–ª–µ–Ω:        4% (–æ—á–µ–Ω—å —Ä–µ–¥–∫–æ)
–û—Å—Ç–∞–ª—å–Ω—ã–µ:   3% (–∫—Ä–∞–π–Ω–µ —Ä–µ–¥–∫–æ)
```

### **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö:**
- **–û–±—â–∞—è accuracy:** 60-80% (–≤–º–µ—Å—Ç–æ 99%)
- **–†–µ–¥–∫–∏–µ –≤–∏–¥—ã:** precision 20-40%
- **–î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–µ –≤–∏–¥—ã:** recall 90%+
- **Balanced accuracy:** 45-65%

---

## üõ†Ô∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. **–ß–µ—Å—Ç–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
```markdown
‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ú–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 99% —Ç–æ—á–Ω–æ—Å—Ç–∏"
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "–ú–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 99% —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö 
             –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö"
```

### 2. **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏**
```python
# –í–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–π accuracy –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
from sklearn.metrics import balanced_accuracy_score, cohen_kappa_score
from sklearn.metrics import classification_report

# –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
balanced_acc = balanced_accuracy_score(y_true, y_pred)
kappa = cohen_kappa_score(y_true, y_pred)
report = classification_report(y_true, y_pred)

# –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
per_class_metrics = classification_report(y_true, y_pred, output_dict=True)
```

### 3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
```python
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
def create_realistic_test_set(X, y, imbalance_ratios):
    """–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º"""
    # –ö–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
    pass

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞
imbalance_levels = [1, 2, 5, 10, 25, 50]  # —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è max:min –∫–ª–∞—Å—Å–∞
```

---

## üìà –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º—ã

### **–°–æ–∑–¥–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏:**
1. `class_balance_impact_analysis.png` - –í–ª–∏—è–Ω–∏–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å
2. `imbalanced_reality_test.png` - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### **–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –∏–∑ –≥—Ä–∞—Ñ–∏–∫–æ–≤:**
- –ü—Ä–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ 1:1 ‚Üí Accuracy = 97%
- –ü—Ä–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ 25:1 ‚Üí Accuracy = 96% (misleading!)
- –ü—Ä–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ 25:1 ‚Üí Balanced Accuracy = 63% (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ)

---

## üéØ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ

### ‚úÖ **–í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ö–û–†–†–ï–ö–¢–ù–´, –ø–æ—Ç–æ–º—É —á—Ç–æ:**
1. **–î–∞–Ω–Ω—ã–µ –∏–¥–µ–∞–ª—å–Ω–æ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã** (150 –æ–±—Ä–∞–∑—Ü–æ–≤ –Ω–∞ –∫–ª–∞—Å—Å)
2. **–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —É—Å–ª–æ–≤–∏—è** –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç —à—É–º –∏ –≤–∞—Ä–∏–∞—Ü–∏–∏
3. **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** —Å —á–µ—Ç–∫–∏–º–∏ —Ä–∞–∑–ª–∏—á–∏—è–º–∏
4. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–º –¥–∞–Ω–Ω—ã–º** –¥–ª—è —Ç–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏–π

### ‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —á–µ—Å—Ç–Ω–æ—Å—Ç—å:**
1. **–ù–µ —ç–∫—Å—Ç—Ä–∞–ø–æ–ª–∏—Ä—É–π—Ç–µ** –Ω–∞ –ø–æ–ª–µ–≤—ã–µ —É—Å–ª–æ–≤–∏—è
2. **–£–∫–∞–∑—ã–≤–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç** –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤  
3. **–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é** –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** (balanced accuracy, per-class metrics)

### üöÄ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã:**
1. **–°–±–æ—Ä –ø–æ–ª–µ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö** —Å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –≤–∏–¥–æ–≤
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏** –∫ —Å–µ–∑–æ–Ω–Ω—ã–º –≤–∞—Ä–∏–∞—Ü–∏—è–º
3. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∞–Ω—Å–∞–º–±–ª–µ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤** –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
4. **–°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –ø–æ—Ä–æ–≥–æ–≤** –¥–ª—è —Ä–µ–¥–∫–∏—Ö –≤–∏–¥–æ–≤

---

## üìö –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

1. **Breiman, L. (2001)** - Random Forests. Machine Learning, 45(1), 5-32.
2. **Geurts, P., Ernst, D., & Wehenkel, L. (2006)** - Extremely randomized trees. Machine Learning, 63(1), 3-42.
3. **Fern√°ndez-Delgado, M., et al. (2014)** - Do we need hundreds of classifiers to solve real world classification problems? JMLR, 15(1), 3133-3181.
4. **He, H., & Garcia, E. A. (2009)** - Learning from imbalanced data. IEEE TKDE, 21(9), 1263-1284.

---

**üìÖ –î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-01-XX  
**üë®‚Äçüî¨ –°—Ç–∞—Ç—É—Å:** –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∞  
**‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –í—ã—Å–æ–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±–æ—Å–Ω–æ–≤–∞–Ω—ã –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã –¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π